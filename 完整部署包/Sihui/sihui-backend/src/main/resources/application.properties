# 应用服务 WEB 访问端口
server.port=8080
# Actuator Web 访问端口
management.server.port=8081
management.endpoints.jmx.exposure.include=*
management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always

# JWT 配置
jwt.secret=SihuiTrainingPlatformSecretKey2024!@#$%^&*()_+ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz
jwt.expiration=86400000
jwt.refresh-expiration=604800000
jwt.issuer=sihui-training-platform
jwt.audience=sihui-users
jwt.clock-skew-seconds=5
jwt.blacklist-enabled=false

# 安全配置
security.jwt.max-login-attempts=5
security.jwt.login-lockout-duration=300000
security.audit.enabled=true
security.audit.log-successful-logins=true
security.audit.log-failed-logins=true
security.audit.log-suspicious-activities=true

# 性能配置
performance.jwt.monitoring-enabled=true
performance.jwt.slow-operation-threshold=100
performance.jwt.alert-failure-rate-threshold=10.0
performance.jwt.alert-response-time-threshold=50

# 数据库配置
spring.datasource.url=jdbc:mysql://localhost:3307/sihui?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true&useConfigs=maxPerformance
spring.datasource.username=root
spring.datasource.password=123456
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA 配置 - 使用update模式让Hibernate自动创建表
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
spring.jpa.properties.hibernate.use_sql_comments=true

# 数据库连接池配置（性能优化）
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.validation-timeout=3000
spring.datasource.hikari.leak-detection-threshold=60000

# Flyway 数据库迁移配置 - 暂时禁用直到解决MySQL 8.0兼容性问题
spring.flyway.enabled=false
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-version=0
spring.flyway.validate-on-migrate=false

# 阿里云OSS配置
aliyun.oss.endpoint=https://oss-cn-guangzhou.aliyuncs.com
aliyun.oss.access-key-id=${ALIYUN_OSS_ACCESS_KEY_ID:your-access-key-id}
aliyun.oss.access-key-secret=${ALIYUN_OSS_ACCESS_KEY_SECRET:your-access-key-secret}
aliyun.oss.bucket-name=${ALIYUN_OSS_BUCKET_NAME:sihui-training-files}
aliyun.oss.domain=${ALIYUN_OSS_DOMAIN:}
aliyun.oss.max-file-size=100MB
aliyun.oss.allowed-file-types=mp4,avi,mov,wmv,flv,mkv,pdf,doc,docx,ppt,pptx,xls,xlsx,txt,jpg,jpeg,png,gif

# DeepSeek AI 配置
deepseek.api.key=${DEEPSEEK_API_KEY:your-deepseek-api-key}
deepseek.api.url=https://api.deepseek.com/v1/chat/completions
deepseek.api.model=deepseek-chat
deepseek.api.temperature=0.7
deepseek.api.max-tokens=1000

# 缓存配置
spring.cache.type=redis
spring.cache.redis.time-to-live=PT30M
spring.cache.redis.cache-null-values=false
spring.cache.redis.key-prefix=sihui:cache:

# Redis配置
spring.redis.host=localhost
spring.redis.port=6379
spring.redis.password=
spring.redis.database=0
spring.redis.timeout=3000ms
spring.redis.jedis.pool.max-active=20
spring.redis.jedis.pool.max-idle=10
spring.redis.jedis.pool.min-idle=5
spring.redis.jedis.pool.max-wait=3000ms

# 服务器配置（性能优化）
server.port=8080
server.tomcat.max-threads=200
server.tomcat.min-spare-threads=20
server.tomcat.max-connections=8192
server.tomcat.accept-count=1000
server.tomcat.connection-timeout=20000
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024

# 日志配置
logging.level.root=INFO
logging.level.com.vote.sihuibackend=DEBUG
logging.level.org.springframework.cache=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# 性能监控配置
management.endpoints.web.exposure.include=health,info,metrics,prometheus,caches
management.endpoint.health.show-details=always
management.endpoint.metrics.enabled=true
management.endpoint.prometheus.enabled=true
management.metrics.export.prometheus.enabled=true

# 线程池配置
spring.task.execution.pool.core-size=8
spring.task.execution.pool.max-size=32
spring.task.execution.pool.queue-capacity=200
spring.task.execution.pool.keep-alive=60s
spring.task.execution.thread-name-prefix=async-task-

# 异步配置
spring.task.scheduling.pool.size=5
spring.task.scheduling.thread-name-prefix=scheduled-task-

# 文件上传配置
spring.servlet.multipart.max-file-size=50MB
spring.servlet.multipart.max-request-size=50MB

# 应用配置
app.name=Sihui Backend
app.version=1.0.0
app.description=四会项目后端服务

# 性能优化配置
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true
spring.jpa.properties.hibernate.generate_statistics=true

# HTTP客户端配置
spring.http.client.connection-timeout=5000
spring.http.client.read-timeout=30000

